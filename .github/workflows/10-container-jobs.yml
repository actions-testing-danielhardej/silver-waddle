name: 10 - Container Jobs

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]
  workflow_dispatch:

jobs:
  container-job:
    runs-on: arc-runner-set
    container:
      image: node:18-alpine
    steps:
      - name: Check Node version
        run: node --version
      
      - name: Check npm version
        run: npm --version
      
      - name: Run Node script
        run: |
          node -e "console.log('Hello from Node.js in a container!')"
          node -e "console.log('Process: ' + process.version)"
  
  service-container:
    runs-on: arc-runner-set
    container: node:18-alpine
    services:
      redis:
        image: redis:alpine
        options: >-
          --health-cmd "redis-cli ping"
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
    steps:
      - name: Check service connectivity
        run: |
          echo "Services are running"
          echo "Redis service should be available at 'redis' hostname"
